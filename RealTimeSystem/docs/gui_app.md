# GUI 可视化应用程序 (gui_app.py)

## 概述

该模块是主机端的图形用户界面程序，使用 PyQt5 和 matplotlib 构建专业的实时数据可视化界面。

## 功能特点

1. **实时数据可视化** - 显示 8 通道热电芯片电压数据
2. **预测结果展示** - 同时显示历史数据和预测结果
3. **通道选择** - 支持查看单个通道或全部通道
4. **预测步数控制** - 支持 1-step 或 10-step 预测
5. **系统状态监控** - 实时显示系统运行状态
6. **专业界面设计** - 符合专业软件的 UI 标准

## 界面布局

### 左侧控制面板

- **系统状态**: 显示当前状态、窗口数据量、接收次数、最新时间戳
- **通道选择**: 下拉菜单选择显示的通道（全部或单个）
- **预测设置**: 选择预测步数（1步或10步）
- **当前电压值**: 实时显示 8 个通道的电压值
- **操作按钮**: 清除数据、刷新图表
- **模型信息**: 显示当前使用的模型信息

### 右侧图表区域

- 全通道模式: 4行2列的子图布局
- 单通道模式: 单个大图显示
- 图例说明: 历史数据、预测结果、实际测量

### 底部状态栏

- 服务器运行状态
- 端口信息

## 使用方法

### 基本启动

```bash
python gui_app.py --port 5000
```

### 完整参数

```bash
python gui_app.py \
    --port 5000 \                    # HTTP 服务端口
    --window-size 60 \               # 滑动窗口大小
    --model-path path/to/model.pth   # 模型文件路径
```

### 测试模式（无真实模型）

```bash
# 不指定模型路径时，将使用模拟推理引擎
python gui_app.py --port 5000
```

## 通道信息

| 索引 | 名称 | 颜色 |
|------|------|------|
| 0 | Yellow | 金色 |
| 1 | Ultraviolet | 深紫 |
| 2 | Infrared | 深红 |
| 3 | Red | 红色 |
| 4 | Green | 绿色 |
| 5 | Blue | 蓝色 |
| 6 | Transparent | 灰色 |
| 7 | Violet | 紫罗兰 |

## 预测显示

### 历史数据

- 实线显示
- 使用各通道对应的颜色
- 显示最近 60 个时间点的数据

### 预测结果

- 虚线显示
- 使用橙色 (#FF5722)
- 带有圆点标记
- 显示 1 或 10 个预测点

## 系统状态说明

| 状态 | 颜色 | 说明 |
|------|------|------|
| 等待数据... | 橙色 | 窗口数据不足 60 个 |
| 数据就绪 | 橙色 | 数据足够，等待推理 |
| 推理中... | 蓝色 | 正在执行模型推理 |
| 推理完成 | 绿色 | 推理完成，结果已更新 |

## 内存优化

- 使用 `deque` 限制预测历史记录数量
- 定时器间隔设置为 1 秒
- 图表数据仅保留必要的时间范围

## 依赖

```
PyQt5>=5.15.0
matplotlib>=3.3.0
numpy>=1.19.0
```

安装依赖：

```bash
pip install PyQt5 matplotlib numpy
```

## 注意事项

1. 确保先启动 GUI 程序，再启动 Pi 端发送程序
2. GUI 程序会自动启动 HTTP 服务器
3. 关闭 GUI 窗口会同时停止 HTTP 服务
4. 建议在具有图形界面的环境中运行

## 截图

启动后，界面将显示：
- 左侧控制面板：系统状态、通道选择、预测设置等
- 右侧图表区域：8 个通道的电压曲线（全通道模式）
- 底部状态栏：服务器状态和端口信息

## 扩展

如需自定义界面样式或添加功能，可以：

1. 修改 `_init_ui()` 方法中的样式表
2. 在 `_create_control_panel()` 中添加新控件
3. 在 `_update_plot()` 中调整图表绘制逻辑
